export const countries = [
  // Africa
  { name: "Algeria", code: "DZ", continent: "Africa", capital: "Algiers", aliases: [] },
  { name: "Angola", code: "AO", continent: "Africa", capital: "Luanda", aliases: [] },
  { name: "Benin", code: "BJ", continent: "Africa", capital: "Porto-Novo", aliases: [] },
  { name: "Botswana", code: "BW", continent: "Africa", capital: "Gaborone", aliases: [] },
  { name: "Burkina Faso", code: "BF", continent: "Africa", capital: "Ouagadougou", aliases: [] },
  { name: "Burundi", code: "BI", continent: "Africa", capital: "Gitega", aliases: [] },
  { name: "Cameroon", code: "CM", continent: "Africa", capital: "Yaoundé", aliases: [] },
  { name: "Cape Verde", code: "CV", continent: "Africa", capital: "Praia", aliases: ["Cabo Verde"] },
  { name: "Central African Republic", code: "CF", continent: "Africa", capital: "Bangui", aliases: ["CAR"] },
  { name: "Chad", code: "TD", continent: "Africa", capital: "N'Djamena", aliases: [] },
  { name: "Comoros", code: "KM", continent: "Africa", capital: "Moroni", aliases: [] },
  { name: "Democratic Republic of the Congo", code: "CD", continent: "Africa", capital: "Kinshasa", aliases: ["DRC", "Congo-Kinshasa", "DR Congo"] },
  { name: "Republic of the Congo", code: "CG", continent: "Africa", capital: "Brazzaville", aliases: ["Congo", "Congo-Brazzaville"] },
  { name: "Djibouti", code: "DJ", continent: "Africa", capital: "Djibouti", aliases: [] },
  { name: "Egypt", code: "EG", continent: "Africa", capital: "Cairo", aliases: [] },
  { name: "Equatorial Guinea", code: "GQ", continent: "Africa", capital: "Malabo", aliases: [] },
  { name: "Eritrea", code: "ER", continent: "Africa", capital: "Asmara", aliases: [] },
  { name: "Eswatini", code: "SZ", continent: "Africa", capital: "Mbabane", aliases: ["Swaziland"] },
  { name: "Ethiopia", code: "ET", continent: "Africa", capital: "Addis Ababa", aliases: [] },
  { name: "Gabon", code: "GA", continent: "Africa", capital: "Libreville", aliases: [] },
  { name: "Gambia", code: "GM", continent: "Africa", capital: "Banjul", aliases: ["The Gambia"] },
  { name: "Ghana", code: "GH", continent: "Africa", capital: "Accra", aliases: [] },
  { name: "Guinea", code: "GN", continent: "Africa", capital: "Conakry", aliases: [] },
  { name: "Guinea-Bissau", code: "GW", continent: "Africa", capital: "Bissau", aliases: [] },
  { name: "Ivory Coast", code: "CI", continent: "Africa", capital: "Yamoussoukro", aliases: ["Côte d'Ivoire", "Cote d'Ivoire"] },
  { name: "Kenya", code: "KE", continent: "Africa", capital: "Nairobi", aliases: [] },
  { name: "Lesotho", code: "LS", continent: "Africa", capital: "Maseru", aliases: [] },
  { name: "Liberia", code: "LR", continent: "Africa", capital: "Monrovia", aliases: [] },
  { name: "Libya", code: "LY", continent: "Africa", capital: "Tripoli", aliases: [] },
  { name: "Madagascar", code: "MG", continent: "Africa", capital: "Antananarivo", aliases: [] },
  { name: "Malawi", code: "MW", continent: "Africa", capital: "Lilongwe", aliases: [] },
  { name: "Mali", code: "ML", continent: "Africa", capital: "Bamako", aliases: [] },
  { name: "Mauritania", code: "MR", continent: "Africa", capital: "Nouakchott", aliases: [] },
  { name: "Mauritius", code: "MU", continent: "Africa", capital: "Port Louis", aliases: [] },
  { name: "Morocco", code: "MA", continent: "Africa", capital: "Rabat", aliases: [] },
  { name: "Mozambique", code: "MZ", continent: "Africa", capital: "Maputo", aliases: [] },
  { name: "Namibia", code: "NA", continent: "Africa", capital: "Windhoek", aliases: [] },
  { name: "Niger", code: "NE", continent: "Africa", capital: "Niamey", aliases: [] },
  { name: "Nigeria", code: "NG", continent: "Africa", capital: "Abuja", aliases: [] },
  { name: "Rwanda", code: "RW", continent: "Africa", capital: "Kigali", aliases: [] },
  { name: "São Tomé and Príncipe", code: "ST", continent: "Africa", capital: "São Tomé", aliases: ["Sao Tome and Principe", "Sao Tome"] },
  { name: "Senegal", code: "SN", continent: "Africa", capital: "Dakar", aliases: [] },
  { name: "Seychelles", code: "SC", continent: "Africa", capital: "Victoria", aliases: [] },
  { name: "Sierra Leone", code: "SL", continent: "Africa", capital: "Freetown", aliases: [] },
  { name: "Somalia", code: "SO", continent: "Africa", capital: "Mogadishu", aliases: [] },
  { name: "South Africa", code: "ZA", continent: "Africa", capital: "Pretoria", aliases: [] },
  { name: "South Sudan", code: "SS", continent: "Africa", capital: "Juba", aliases: [] },
  { name: "Sudan", code: "SD", continent: "Africa", capital: "Khartoum", aliases: [] },
  { name: "Tanzania", code: "TZ", continent: "Africa", capital: "Dodoma", aliases: [] },
  { name: "Togo", code: "TG", continent: "Africa", capital: "Lomé", aliases: [] },
  { name: "Tunisia", code: "TN", continent: "Africa", capital: "Tunis", aliases: [] },
  { name: "Uganda", code: "UG", continent: "Africa", capital: "Kampala", aliases: [] },
  { name: "Zambia", code: "ZM", continent: "Africa", capital: "Lusaka", aliases: [] },
  { name: "Zimbabwe", code: "ZW", continent: "Africa", capital: "Harare", aliases: [] },

  // Asia
  { name: "Afghanistan", code: "AF", continent: "Asia", capital: "Kabul", aliases: [] },
  { name: "Armenia", code: "AM", continent: "Asia", capital: "Yerevan", aliases: [] },
  { name: "Azerbaijan", code: "AZ", continent: "Asia", capital: "Baku", aliases: [] },
  { name: "Bahrain", code: "BH", continent: "Asia", capital: "Manama", aliases: [] },
  { name: "Bangladesh", code: "BD", continent: "Asia", capital: "Dhaka", aliases: [] },
  { name: "Bhutan", code: "BT", continent: "Asia", capital: "Thimphu", aliases: [] },
  { name: "Brunei", code: "BN", continent: "Asia", capital: "Bandar Seri Begawan", aliases: [] },
  { name: "Cambodia", code: "KH", continent: "Asia", capital: "Phnom Penh", aliases: [] },
  { name: "China", code: "CN", continent: "Asia", capital: "Beijing", aliases: ["People's Republic of China", "PRC"] },
  { name: "Cyprus", code: "CY", continent: "Asia", capital: "Nicosia", aliases: [] },
  { name: "Georgia", code: "GE", continent: "Asia", capital: "Tbilisi", aliases: [] },
  { name: "India", code: "IN", continent: "Asia", capital: "New Delhi", aliases: [] },
  { name: "Indonesia", code: "ID", continent: "Asia", capital: "Jakarta", aliases: [] },
  { name: "Iran", code: "IR", continent: "Asia", capital: "Tehran", aliases: [] },
  { name: "Iraq", code: "IQ", continent: "Asia", capital: "Baghdad", aliases: [] },
  { name: "Israel", code: "IL", continent: "Asia", capital: "Jerusalem", aliases: [] },
  { name: "Japan", code: "JP", continent: "Asia", capital: "Tokyo", aliases: [] },
  { name: "Jordan", code: "JO", continent: "Asia", capital: "Amman", aliases: [] },
  { name: "Kazakhstan", code: "KZ", continent: "Asia", capital: "Astana", aliases: [] },
  { name: "Kuwait", code: "KW", continent: "Asia", capital: "Kuwait City", aliases: [] },
  { name: "Kyrgyzstan", code: "KG", continent: "Asia", capital: "Bishkek", aliases: [] },
  { name: "Laos", code: "LA", continent: "Asia", capital: "Vientiane", aliases: [] },
  { name: "Lebanon", code: "LB", continent: "Asia", capital: "Beirut", aliases: [] },
  { name: "Malaysia", code: "MY", continent: "Asia", capital: "Kuala Lumpur", aliases: [] },
  { name: "Maldives", code: "MV", continent: "Asia", capital: "Malé", aliases: [] },
  { name: "Mongolia", code: "MN", continent: "Asia", capital: "Ulaanbaatar", aliases: [] },
  { name: "Myanmar", code: "MM", continent: "Asia", capital: "Naypyidaw", aliases: ["Burma"] },
  { name: "Nepal", code: "NP", continent: "Asia", capital: "Kathmandu", aliases: [] },
  { name: "North Korea", code: "KP", continent: "Asia", capital: "Pyongyang", aliases: ["DPRK"] },
  { name: "Oman", code: "OM", continent: "Asia", capital: "Muscat", aliases: [] },
  { name: "Pakistan", code: "PK", continent: "Asia", capital: "Islamabad", aliases: [] },
  { name: "Palestine", code: "PS", continent: "Asia", capital: "Ramallah", aliases: [] },
  { name: "Philippines", code: "PH", continent: "Asia", capital: "Manila", aliases: [] },
  { name: "Qatar", code: "QA", continent: "Asia", capital: "Doha", aliases: [] },
  { name: "Saudi Arabia", code: "SA", continent: "Asia", capital: "Riyadh", aliases: [] },
  { name: "Singapore", code: "SG", continent: "Asia", capital: "Singapore", aliases: [] },
  { name: "South Korea", code: "KR", continent: "Asia", capital: "Seoul", aliases: ["Korea", "Republic of Korea"] },
  { name: "Sri Lanka", code: "LK", continent: "Asia", capital: "Sri Jayawardenepura Kotte", aliases: [] },
  { name: "Syria", code: "SY", continent: "Asia", capital: "Damascus", aliases: [] },
  { name: "Taiwan", code: "TW", continent: "Asia", capital: "Taipei", aliases: [] },
  { name: "Tajikistan", code: "TJ", continent: "Asia", capital: "Dushanbe", aliases: [] },
  { name: "Thailand", code: "TH", continent: "Asia", capital: "Bangkok", aliases: [] },
  { name: "Timor-Leste", code: "TL", continent: "Asia", capital: "Dili", aliases: ["East Timor"] },
  { name: "Turkey", code: "TR", continent: "Asia", capital: "Ankara", aliases: ["Turkiye"] },
  { name: "Turkmenistan", code: "TM", continent: "Asia", capital: "Ashgabat", aliases: [] },
  { name: "United Arab Emirates", code: "AE", continent: "Asia", capital: "Abu Dhabi", aliases: ["UAE"] },
  { name: "Uzbekistan", code: "UZ", continent: "Asia", capital: "Tashkent", aliases: [] },
  { name: "Vietnam", code: "VN", continent: "Asia", capital: "Hanoi", aliases: [] },
  { name: "Yemen", code: "YE", continent: "Asia", capital: "Sana'a", aliases: [] },

  // Europe
  { name: "Albania", code: "AL", continent: "Europe", capital: "Tirana", aliases: [] },
  { name: "Andorra", code: "AD", continent: "Europe", capital: "Andorra la Vella", aliases: [] },
  { name: "Austria", code: "AT", continent: "Europe", capital: "Vienna", aliases: [] },
  { name: "Belarus", code: "BY", continent: "Europe", capital: "Minsk", aliases: [] },
  { name: "Belgium", code: "BE", continent: "Europe", capital: "Brussels", aliases: [] },
  { name: "Bosnia and Herzegovina", code: "BA", continent: "Europe", capital: "Sarajevo", aliases: ["Bosnia"] },
  { name: "Bulgaria", code: "BG", continent: "Europe", capital: "Sofia", aliases: [] },
  { name: "Croatia", code: "HR", continent: "Europe", capital: "Zagreb", aliases: [] },
  { name: "Czech Republic", code: "CZ", continent: "Europe", capital: "Prague", aliases: ["Czechia"] },
  { name: "Denmark", code: "DK", continent: "Europe", capital: "Copenhagen", aliases: [] },
  { name: "Estonia", code: "EE", continent: "Europe", capital: "Tallinn", aliases: [] },
  { name: "Finland", code: "FI", continent: "Europe", capital: "Helsinki", aliases: [] },
  { name: "France", code: "FR", continent: "Europe", capital: "Paris", aliases: [] },
  { name: "Germany", code: "DE", continent: "Europe", capital: "Berlin", aliases: [] },
  { name: "Greece", code: "GR", continent: "Europe", capital: "Athens", aliases: [] },
  { name: "Hungary", code: "HU", continent: "Europe", capital: "Budapest", aliases: [] },
  { name: "Iceland", code: "IS", continent: "Europe", capital: "Reykjavik", aliases: [] },
  { name: "Ireland", code: "IE", continent: "Europe", capital: "Dublin", aliases: [] },
  { name: "Italy", code: "IT", continent: "Europe", capital: "Rome", aliases: [] },
  { name: "Kosovo", code: "XK", continent: "Europe", capital: "Pristina", aliases: [] },
  { name: "Latvia", code: "LV", continent: "Europe", capital: "Riga", aliases: [] },
  { name: "Liechtenstein", code: "LI", continent: "Europe", capital: "Vaduz", aliases: [] },
  { name: "Lithuania", code: "LT", continent: "Europe", capital: "Vilnius", aliases: [] },
  { name: "Luxembourg", code: "LU", continent: "Europe", capital: "Luxembourg City", aliases: [] },
  { name: "Malta", code: "MT", continent: "Europe", capital: "Valletta", aliases: [] },
  { name: "Moldova", code: "MD", continent: "Europe", capital: "Chișinău", aliases: [] },
  { name: "Monaco", code: "MC", continent: "Europe", capital: "Monaco", aliases: [] },
  { name: "Montenegro", code: "ME", continent: "Europe", capital: "Podgorica", aliases: [] },
  { name: "Netherlands", code: "NL", continent: "Europe", capital: "Amsterdam", aliases: ["Holland"] },
  { name: "North Macedonia", code: "MK", continent: "Europe", capital: "Skopje", aliases: ["Macedonia"] },
  { name: "Norway", code: "NO", continent: "Europe", capital: "Oslo", aliases: [] },
  { name: "Poland", code: "PL", continent: "Europe", capital: "Warsaw", aliases: [] },
  { name: "Portugal", code: "PT", continent: "Europe", capital: "Lisbon", aliases: [] },
  { name: "Romania", code: "RO", continent: "Europe", capital: "Bucharest", aliases: [] },
  { name: "Russia", code: "RU", continent: "Europe", capital: "Moscow", aliases: ["Russian Federation"] },
  { name: "San Marino", code: "SM", continent: "Europe", capital: "San Marino", aliases: [] },
  { name: "Serbia", code: "RS", continent: "Europe", capital: "Belgrade", aliases: [] },
  { name: "Slovakia", code: "SK", continent: "Europe", capital: "Bratislava", aliases: [] },
  { name: "Slovenia", code: "SI", continent: "Europe", capital: "Ljubljana", aliases: [] },
  { name: "Spain", code: "ES", continent: "Europe", capital: "Madrid", aliases: [] },
  { name: "Sweden", code: "SE", continent: "Europe", capital: "Stockholm", aliases: [] },
  { name: "Switzerland", code: "CH", continent: "Europe", capital: "Bern", aliases: [] },
  { name: "Ukraine", code: "UA", continent: "Europe", capital: "Kyiv", aliases: [] },
  { name: "United Kingdom", code: "GB", continent: "Europe", capital: "London", aliases: ["UK", "Great Britain", "Britain", "England"] },
  { name: "Vatican City", code: "VA", continent: "Europe", capital: "Vatican City", aliases: ["Vatican", "Holy See"] },

  // North America
  { name: "Antigua and Barbuda", code: "AG", continent: "North America", capital: "St. John's", aliases: [] },
  { name: "Bahamas", code: "BS", continent: "North America", capital: "Nassau", aliases: ["The Bahamas"] },
  { name: "Barbados", code: "BB", continent: "North America", capital: "Bridgetown", aliases: [] },
  { name: "Belize", code: "BZ", continent: "North America", capital: "Belmopan", aliases: [] },
  { name: "Canada", code: "CA", continent: "North America", capital: "Ottawa", aliases: [] },
  { name: "Costa Rica", code: "CR", continent: "North America", capital: "San José", aliases: [] },
  { name: "Cuba", code: "CU", continent: "North America", capital: "Havana", aliases: [] },
  { name: "Dominica", code: "DM", continent: "North America", capital: "Roseau", aliases: [] },
  { name: "Dominican Republic", code: "DO", continent: "North America", capital: "Santo Domingo", aliases: [] },
  { name: "El Salvador", code: "SV", continent: "North America", capital: "San Salvador", aliases: [] },
  { name: "Grenada", code: "GD", continent: "North America", capital: "St. George's", aliases: [] },
  { name: "Guatemala", code: "GT", continent: "North America", capital: "Guatemala City", aliases: [] },
  { name: "Haiti", code: "HT", continent: "North America", capital: "Port-au-Prince", aliases: [] },
  { name: "Honduras", code: "HN", continent: "North America", capital: "Tegucigalpa", aliases: [] },
  { name: "Jamaica", code: "JM", continent: "North America", capital: "Kingston", aliases: [] },
  { name: "Mexico", code: "MX", continent: "North America", capital: "Mexico City", aliases: [] },
  { name: "Nicaragua", code: "NI", continent: "North America", capital: "Managua", aliases: [] },
  { name: "Panama", code: "PA", continent: "North America", capital: "Panama City", aliases: [] },
  { name: "Saint Kitts and Nevis", code: "KN", continent: "North America", capital: "Basseterre", aliases: ["St Kitts and Nevis"] },
  { name: "Saint Lucia", code: "LC", continent: "North America", capital: "Castries", aliases: ["St Lucia"] },
  { name: "Saint Vincent and the Grenadines", code: "VC", continent: "North America", capital: "Kingstown", aliases: ["St Vincent"] },
  { name: "Trinidad and Tobago", code: "TT", continent: "North America", capital: "Port of Spain", aliases: [] },
  { name: "United States", code: "US", continent: "North America", capital: "Washington, D.C.", aliases: ["USA", "United States of America", "America"] },

  // South America
  { name: "Argentina", code: "AR", continent: "South America", capital: "Buenos Aires", aliases: [] },
  { name: "Bolivia", code: "BO", continent: "South America", capital: "Sucre", aliases: [] },
  { name: "Brazil", code: "BR", continent: "South America", capital: "Brasília", aliases: [] },
  { name: "Chile", code: "CL", continent: "South America", capital: "Santiago", aliases: [] },
  { name: "Colombia", code: "CO", continent: "South America", capital: "Bogotá", aliases: [] },
  { name: "Ecuador", code: "EC", continent: "South America", capital: "Quito", aliases: [] },
  { name: "Guyana", code: "GY", continent: "South America", capital: "Georgetown", aliases: [] },
  { name: "Paraguay", code: "PY", continent: "South America", capital: "Asunción", aliases: [] },
  { name: "Peru", code: "PE", continent: "South America", capital: "Lima", aliases: [] },
  { name: "Suriname", code: "SR", continent: "South America", capital: "Paramaribo", aliases: [] },
  { name: "Uruguay", code: "UY", continent: "South America", capital: "Montevideo", aliases: [] },
  { name: "Venezuela", code: "VE", continent: "South America", capital: "Caracas", aliases: [] },

  // Oceania
  { name: "Australia", code: "AU", continent: "Oceania", capital: "Canberra", aliases: [] },
  { name: "Fiji", code: "FJ", continent: "Oceania", capital: "Suva", aliases: [] },
  { name: "Kiribati", code: "KI", continent: "Oceania", capital: "Tarawa", aliases: [] },
  { name: "Marshall Islands", code: "MH", continent: "Oceania", capital: "Majuro", aliases: [] },
  { name: "Micronesia", code: "FM", continent: "Oceania", capital: "Palikir", aliases: ["Federated States of Micronesia"] },
  { name: "Nauru", code: "NR", continent: "Oceania", capital: "Yaren", aliases: [] },
  { name: "New Zealand", code: "NZ", continent: "Oceania", capital: "Wellington", aliases: [] },
  { name: "Palau", code: "PW", continent: "Oceania", capital: "Ngerulmud", aliases: [] },
  { name: "Papua New Guinea", code: "PG", continent: "Oceania", capital: "Port Moresby", aliases: ["PNG"] },
  { name: "Samoa", code: "WS", continent: "Oceania", capital: "Apia", aliases: [] },
  { name: "Solomon Islands", code: "SB", continent: "Oceania", capital: "Honiara", aliases: [] },
  { name: "Tonga", code: "TO", continent: "Oceania", capital: "Nuku'alofa", aliases: [] },
  { name: "Tuvalu", code: "TV", continent: "Oceania", capital: "Funafuti", aliases: [] },
  { name: "Vanuatu", code: "VU", continent: "Oceania", capital: "Port Vila", aliases: [] },
];

export const continents = [
  "Africa",
  "Asia",
  "Europe",
  "North America",
  "South America",
  "Oceania",
];

export const continentColors = {
  Africa: "#e74c3c",
  Asia: "#f39c12",
  Europe: "#3498db",
  "North America": "#9b59b6",
  "South America": "#2ecc71",
  Oceania: "#1abc9c",
};

export const getCountriesByContinent = (continent) => {
  return countries.filter((c) => c.continent === continent);
};

// Calculate Levenshtein distance between two strings
const levenshteinDistance = (str1, str2) => {
  const m = str1.length;
  const n = str2.length;

  // Create a matrix to store distances
  const dp = Array(m + 1)
    .fill(null)
    .map(() => Array(n + 1).fill(0));

  // Initialize first row and column
  for (let i = 0; i <= m; i++) dp[i][0] = i;
  for (let j = 0; j <= n; j++) dp[0][j] = j;

  // Fill in the rest of the matrix
  for (let i = 1; i <= m; i++) {
    for (let j = 1; j <= n; j++) {
      const cost = str1[i - 1] === str2[j - 1] ? 0 : 1;
      dp[i][j] = Math.min(
        dp[i - 1][j] + 1, // deletion
        dp[i][j - 1] + 1, // insertion
        dp[i - 1][j - 1] + cost // substitution
      );
    }
  }

  return dp[m][n];
};

// Calculate similarity ratio (0 to 1, where 1 is exact match)
const getSimilarity = (str1, str2) => {
  const maxLength = Math.max(str1.length, str2.length);
  if (maxLength === 0) return 1;
  const distance = levenshteinDistance(str1, str2);
  return 1 - distance / maxLength;
};

// Import French country translations
import { countryTranslations } from "../i18n/translations";

const frenchCountryData = countryTranslations.fr;

export const findCountry = (input, language = "en") => {
  const normalizedInput = input.toLowerCase().trim();

  if (language === "fr") {
    // Try to match French names
    for (const country of countries) {
      const frData = frenchCountryData[country.code];
      if (frData) {
        if (frData.name.toLowerCase() === normalizedInput) {
          return country;
        }
        if (frData.aliases.some((a) => a.toLowerCase() === normalizedInput)) {
          return country;
        }
      }
    }

    // Fuzzy matching for French
    const SIMILARITY_THRESHOLD = 0.75;
    const MIN_INPUT_LENGTH = 3;

    if (normalizedInput.length >= MIN_INPUT_LENGTH) {
      let bestMatch = null;
      let bestSimilarity = 0;

      for (const country of countries) {
        const frData = frenchCountryData[country.code];
        if (frData) {
          const nameSimilarity = getSimilarity(normalizedInput, frData.name.toLowerCase());
          if (nameSimilarity > bestSimilarity && nameSimilarity >= SIMILARITY_THRESHOLD) {
            bestSimilarity = nameSimilarity;
            bestMatch = country;
          }

          for (const alias of frData.aliases) {
            const aliasSimilarity = getSimilarity(normalizedInput, alias.toLowerCase());
            if (aliasSimilarity > bestSimilarity && aliasSimilarity >= SIMILARITY_THRESHOLD) {
              bestSimilarity = aliasSimilarity;
              bestMatch = country;
            }
          }
        }
      }

      if (bestMatch) return bestMatch;
    }
  }

  // English matching (default)
  const exactMatch = countries.find(
    (c) =>
      c.name.toLowerCase() === normalizedInput ||
      c.aliases.some((a) => a.toLowerCase() === normalizedInput)
  );

  if (exactMatch) return exactMatch;

  // If no exact match, try fuzzy matching
  const SIMILARITY_THRESHOLD = 0.75;
  const MIN_INPUT_LENGTH = 3;

  if (normalizedInput.length < MIN_INPUT_LENGTH) return null;

  let bestMatch = null;
  let bestSimilarity = 0;

  for (const country of countries) {
    const nameSimilarity = getSimilarity(
      normalizedInput,
      country.name.toLowerCase()
    );
    if (nameSimilarity > bestSimilarity && nameSimilarity >= SIMILARITY_THRESHOLD) {
      bestSimilarity = nameSimilarity;
      bestMatch = country;
    }

    for (const alias of country.aliases) {
      const aliasSimilarity = getSimilarity(
        normalizedInput,
        alias.toLowerCase()
      );
      if (aliasSimilarity > bestSimilarity && aliasSimilarity >= SIMILARITY_THRESHOLD) {
        bestSimilarity = aliasSimilarity;
        bestMatch = country;
      }
    }
  }

  return bestMatch;
};

export const getCountryByCode = (code) => {
  return countries.find((c) => c.code.toLowerCase() === code.toLowerCase());
};
